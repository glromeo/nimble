<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<script type="module">
    import {molecule} from '../atoms/atoms.mjs'
    import {html} from './html.mjs'
    import {html as preactHtml, render} from 'https://unpkg.com/htm/preact/standalone.module.js'
    import {parseHTML} from './parseHTML.mjs'

    const fixture = (a, b, c) => `
        <body>
            <!-- This is a comment -->
            <div id="container" class="main-container">
                <header>
                    <h1 line="${a}">Welcome</h1>
                    <nav>
                        <ul>
                            <li><a href="#" title="Home">Home</a></li>
                            <li><a href="#" title="About">About</a></li>
                            <li><a href="#" title="Contact">Contact ${b}</a></li>
                        </ul>
                    </nav>
                </header>
                <!-- End of header -->
                <section version=${c}>
                    <article>
                        <h2>Article Title</h2>
                        <p>This is a sample article.</p>
                        <footer>
                            <p>Published on: <time datetime="2024-03-17">March 17, 2024</time></p>
                        </footer>
                    </article>
                </section>
            </div>
        </body>
    `

    const scope = molecule()

    setTimeout(() => requestAnimationFrame(() => {
        console.time('parse time')
        for (let i = 0; i < 1000; i++) try {
            parseHTML(fixture(Math.random() * 1000, Math.random() * 1000, Math.random() * 1000))
        } catch (error) {
            console.error(error)
            i = Number.MAX_SAFE_INTEGER
        }
        console.timeEnd('parse time')
    }), 0)

    setTimeout(() => requestAnimationFrame(() => {
        console.time('preact render time')
        for (let i = 0; i < 350; i++) try {
            render(preactHtml`
                <body line="${Math.random() * 1000}">
                <!-- This is a comment ${`${i}`} -->
                ${`${i}`}
                <div id="container" class="main-container" line="${Math.random() * 1000}">
                    <header>
                        <h1 line="${Math.random() * 1000}">Welcome ${`${i}`}</h1>
                        <nav>
                            <ul line="${Math.random() * 1000}">
                                <li line="${Math.random() * 1000}"><a href="#" title="Home">Home ${`${i}`}</a></li>
                                <li line="${Math.random() * 1000}"><a href="#" title="About">About</a>${`${i}`}</li>
                                <li line="${Math.random() * 1000}"><a href="#" title="Contact">Contact ${`${i}`}</a>
                                </li>
                            </ul>
                        </nav>
                    </header>
                    <!-- End of header -->
                    <section version=${Math.random() * 1000}>
                        <article>
                            <h2 line="${Math.random() * 1000}">Article Title ${`${i}`}</h2>
                            <p line="${Math.random() * 1000}">This is a sample article. ${`${i}`}</p>
                            <footer line="${Math.random() * 1000}">
                                <p line="${Math.random() * 1000}">Published on:
                                    <time datetime="2024-03-17">March 17, 2024</time>
                                </p>
                            </footer>
                        </article>
                    </section>
                </div>
                ${`${i}`}
                ${`${i}`}
                </body>
            `, document.createDocumentFragment())
        } catch (error) {
            console.error(error)
            i = Number.MAX_SAFE_INTEGER
        }
        console.timeEnd('preact render time')
    }), 1000)

    setTimeout(() => requestAnimationFrame(() => {
        console.time('html render time')
        for (let i = 0; i < 350; i++) try {
            html`
            <body line="${Math.random() * 1000}">
            <!-- This is a comment ${`${i}`} -->
            ${`${i}`}
            <div id="container" class="main-container" line="${Math.random() * 1000}">
                <header>
                    <h1 line="${Math.random() * 1000}">Welcome ${`${i}`}</h1>
                    <nav>
                        <ul line="${Math.random() * 1000}">
                            <li line="${Math.random() * 1000}"><a href="#" title="Home">Home ${`${i}`}</a></li>
                            <li line="${Math.random() * 1000}"><a href="#" title="About">About</a>${`${i}`}</li>
                            <li line="${Math.random() * 1000}"><a href="#" title="Contact">Contact ${`${i}`}</a></li>
                        </ul>
                    </nav>
                </header>
                <!-- End of header -->
                <section version=${Math.random() * 1000}>
                    <article>
                        <h2 line="${Math.random() * 1000}">Article Title ${`${i}`}</h2>
                        <p line="${Math.random() * 1000}">This is a sample article. ${`${i}`}</p>
                        <footer line="${Math.random() * 1000}">
                            <p line="${Math.random() * 1000}">Published on: <time datetime="2024-03-17">March 17, 2024</time></p>
                        </footer>
                    </article>
                </section>
            </div>
            ${`${i}`}
            ${`${i}`}
            </body>
        `(scope)
        } catch (error) {
            console.error(error)
            i = Number.MAX_SAFE_INTEGER
        }
        console.timeEnd('html render time')
    }), 2000)

</script>
</body>
</html>